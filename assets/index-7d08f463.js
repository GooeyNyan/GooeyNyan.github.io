import{r as b,b2 as a,j as K,b3 as Ie,b4 as Se,b5 as we,b6 as Me,R as ke}from"./vendor-db3fbea5.js";import{S as p,l as q,d as U,T as h,a as Y,b as Le,c as Re,L as f,e as Ae,f as Je,h as L,r as R,D as Z,Y as I,u as Fe}from"./common-8f3315e3.js";import{F as g,m as Pe,I as S,P as O,C as Ve,t as Ee,T as He,D as Oe,M as Ue,R as y,S as v,B as We}from"./antd-d0562320.js";import"./actionName-f5726d88.js";import"./keigenns-316524d1.js";import"./status-112fc016.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const m of s)if(m.type==="childList")for(const C of m.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&r(C)}).observe(document,{childList:!0,subtree:!0});function i(s){const m={};return s.integrity&&(m.integrity=s.integrity),s.referrerPolicy&&(m.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?m.credentials="include":s.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function r(s){if(s.ep)return;s.ep=!0;const m=i(s);fetch(s.href,m)}})();const Be=(e,t)=>({startTimer:s=>{const m=setInterval(()=>{t({type:p.UpdateDuration})},1e3);t({type:p.StartCombat,startTime:s,timer:m,endTime:void 0,inCombat:!0,combatDuration:"00:00"})},stopTimer:s=>{t({type:p.EndCombat,startTime:void 0,endTime:s,timer:void 0,inCombat:!1})}}),$e={NONE:0,Paladin:19,Monk:20,Warrior:21,Dragoon:22,Bard:23,WhiteMage:24,BlackMage:25,Summoner:27,Scholar:28,Ninja:30,Machinist:31,DarkKnight:32,Astrologian:33,Samurai:34,RedMage:35,Gunbreaker:37,Dancer:38,Reaper:39,Sage:40},W={NONE:0,GLA:1,PGL:2,MRD:3,LNC:4,ARC:5,CNJ:6,THM:7,CRP:8,BSM:9,ARM:10,GSM:11,LTW:12,WVR:13,ALC:14,CUL:15,MIN:16,BTN:17,FSH:18,PLD:19,MNK:20,WAR:21,DRG:22,BRD:23,WHM:24,BLM:25,ACN:26,SMN:27,SCH:28,ROG:29,NIN:30,MCH:31,DRK:32,AST:33,SAM:34,RDM:35,BLU:36,GNB:37,DNC:38,RPR:39,SGE:40},pe={NONE:{en:"Adventurer",ja:"ã™ã£ã´ã‚“å£«",cn:"å†’é™©è€…",simple1:"å†’",simple2:"å†’é™©",icon:"062043",iconFramed:"062143",iconV3:"062043"},GLA:{en:"Gladiator",ja:"å‰£è¡“å£«",cn:"å‰‘æœ¯å¸ˆ",simple1:"å‰‘",simple2:"å‰‘æœ¯",icon:"062001",iconFramed:"062101",iconV3:"062301"},PGL:{en:"Pugilist",ja:"æ ¼é—˜å£«",cn:"æ ¼æ–—å®¶",simple1:"æ–—",simple2:"æ ¼æ–—",icon:"062002",iconFramed:"062102",iconV3:"062302"},MRD:{en:"Marauder",ja:"æ–§è¡“å£«",cn:"æ–§æœ¯å¸ˆ",simple1:"æ–§",simple2:"æ–§æœ¯",icon:"062003",iconFramed:"062103",iconV3:"062303"},LNC:{en:"Lancer",ja:"æ§è¡“å£«",cn:"æªæœ¯å¸ˆ",simple1:"æª",simple2:"æªæœ¯",icon:"062004",iconFramed:"062104",iconV3:"062304"},ARC:{en:"Archer",ja:"å¼“è¡“å£«",cn:"å¼“ç®­æ‰‹",simple1:"å¼“",simple2:"å¼“ç®­",icon:"062005",iconFramed:"062105",iconV3:"062305"},CNJ:{en:"Conjurer",ja:"å¹»è¡“å£«",cn:"å¹»æœ¯å¸ˆ",simple1:"å¹»",simple2:"å¹»æœ¯",icon:"062006",iconFramed:"062106",iconV3:"062306"},THM:{en:"Thaumaturge",ja:"å‘ªè¡“å£«",cn:"å’’æœ¯å¸ˆ",simple1:"å’’",simple2:"å’’æœ¯",icon:"062007",iconFramed:"062107",iconV3:"062307"},CRP:{en:"Carpenter",ja:"æœ¨å·¥å¸«",cn:"åˆ»æœ¨åŒ ",simple1:"åˆ»",simple2:"åˆ»æœ¨",icon:"062008",iconFramed:"062108",iconV3:"062310"},BSM:{en:"Blacksmith",ja:"é›å†¶å¸«",cn:"é”»é“åŒ ",simple1:"é”»",simple2:"é”»é“",icon:"062009",iconFramed:"062109",iconV3:"062311"},ARM:{en:"Armorer",ja:"ç”²å†‘å¸«",cn:"é“¸ç”²åŒ ",simple1:"é“¸",simple2:"é“¸ç”²",icon:"062010",iconFramed:"062110",iconV3:"062312"},GSM:{en:"Goldsmith",ja:"å½«é‡‘å¸«",cn:"é›•é‡‘åŒ ",simple1:"é›•",simple2:"é›•é‡‘",icon:"062011",iconFramed:"062111",iconV3:"062313"},LTW:{en:"Leatherworker",ja:"é©ç´°å·¥å¸«",cn:"åˆ¶é©åŒ ",simple1:"é©",simple2:"åˆ¶é©",icon:"062012",iconFramed:"062112",iconV3:"062314"},WVR:{en:"Weaver",ja:"è£ç¸«å¸«",cn:"è£è¡£åŒ ",simple1:"è£",simple2:"è£è¡£",icon:"062013",iconFramed:"062113",iconV3:"062315"},ALC:{en:"Alchemist",ja:"éŒ¬é‡‘è¡“å¸«",cn:"ç‚¼é‡‘æœ¯å£«",simple1:"ç‚¼",simple2:"ç‚¼é‡‘",icon:"062014",iconFramed:"062114",iconV3:"062316"},CUL:{en:"Culinarian",ja:"èª¿ç†å¸«",cn:"çƒ¹è°ƒå¸ˆ",simple1:"çƒ¹",simple2:"çƒ¹è°ƒ",icon:"062015",iconFramed:"062115",iconV3:"062317"},MIN:{en:"Miner",ja:"æ¡æ˜å¸«",cn:"é‡‡çŸ¿å·¥",simple1:"é‡‡",simple2:"é‡‡çŸ¿",icon:"062016",iconFramed:"062116",iconV3:"062318"},BTN:{en:"Botanist",ja:"åœ’èŠ¸å¸«",cn:"å›­è‰ºå·¥",simple1:"å›­",simple2:"å›­è‰º",icon:"062017",iconFramed:"062117",iconV3:"062319"},FSH:{en:"Fisher",ja:"æ¼å¸«",cn:"æ•é±¼äºº",simple1:"æ•",simple2:"æ•é±¼",icon:"062018",iconFramed:"062118",iconV3:"062320"},PLD:{en:"Paladin",ja:"ãƒŠã‚¤ãƒˆ",cn:"éª‘å£«",simple1:"éª‘",simple2:"éª‘å£«",icon:"062019",iconFramed:"062119",iconV3:"062401"},MNK:{en:"Monk",ja:"ãƒ¢ãƒ³ã‚¯",cn:"æ­¦åƒ§",simple1:"åƒ§",simple2:"æ­¦åƒ§",icon:"062020",iconFramed:"062120",iconV3:"062402"},WAR:{en:"Warrior",ja:"æˆ¦å£«",cn:"æˆ˜å£«",simple1:"æˆ˜",simple2:"æˆ˜å£«",icon:"062021",iconFramed:"062121",iconV3:"062403"},DRG:{en:"Dragoon",ja:"ç«œé¨å£«",cn:"é¾™éª‘å£«",simple1:"é¾™",simple2:"é¾™éª‘",icon:"062022",iconFramed:"062122",iconV3:"062404"},BRD:{en:"Bard",ja:"åŸéŠè©©äºº",cn:"åŸæ¸¸è¯—äºº",simple1:"è¯—",simple2:"è¯—äºº",icon:"062023",iconFramed:"062123",iconV3:"062405"},WHM:{en:"White Mage",ja:"ç™½é­”é“å£«",cn:"ç™½é­”æ³•å¸ˆ",simple1:"ç™½",simple2:"ç™½é­”",icon:"062024",iconFramed:"062124",iconV3:"062406"},BLM:{en:"Black Mage",ja:"é»’é­”é“å£«",cn:"é»‘é­”æ³•å¸ˆ",simple1:"é»‘",simple2:"é»‘é­”",icon:"062025",iconFramed:"062125",iconV3:"062407"},ACN:{en:"Arcanist",ja:"å·´è¡“å£«",cn:"ç§˜æœ¯å¸ˆ",simple1:"ç§˜",simple2:"ç§˜æœ¯",icon:"062026",iconFramed:"062126",iconV3:"062308"},SMN:{en:"Summoner",ja:"å¬å–šå£«",cn:"å¬å”¤å¸ˆ",simple1:"å¬",simple2:"å¬å”¤",icon:"062027",iconFramed:"062127",iconV3:"062408"},SCH:{en:"Scholar",ja:"å­¦è€…",cn:"å­¦è€…",simple1:"å­¦",simple2:"å­¦è€…",icon:"062028",iconFramed:"062128",iconV3:"062409"},ROG:{en:"Rogue",ja:"åŒå‰£å£«",cn:"åŒå‰‘å¸ˆ",simple1:"åŒ",simple2:"åŒå‰‘",icon:"062029",iconFramed:"062129",iconV3:"062309"},NIN:{en:"Ninja",ja:"å¿è€…",cn:"å¿è€…",simple1:"å¿",simple2:"å¿è€…",icon:"062030",iconFramed:"062130",iconV3:"062410"},MCH:{en:"Machinist",ja:"æ©Ÿå·¥å£«",cn:"æœºå·¥å£«",simple1:"æœº",simple2:"æœºå·¥",icon:"062031",iconFramed:"062131",iconV3:"062411"},DRK:{en:"Dark Knight",ja:"æš—é»’é¨å£«",cn:"æš—é»‘éª‘å£«",simple1:"æš—",simple2:"æš—éª‘",icon:"062032",iconFramed:"062132",iconV3:"062412"},AST:{en:"Astrologian",ja:"å æ˜Ÿè¡“å¸«",cn:"å æ˜Ÿæœ¯å£«",simple1:"å ",simple2:"å æ˜Ÿ",icon:"062033",iconFramed:"062133",iconV3:"062413"},SAM:{en:"Samurai",ja:"ä¾",cn:"æ­¦å£«",simple1:"æ­¦",simple2:"æ­¦å£«",icon:"062034",iconFramed:"062134",iconV3:"062414"},RDM:{en:"Red Mage",ja:"èµ¤é­”é“å£«",cn:"èµ¤é­”æ³•å¸ˆ",simple1:"èµ¤",simple2:"èµ¤é­”",icon:"062035",iconFramed:"062135",iconV3:"062415"},BLU:{en:"Blue Mage",ja:"é’é­”é“å£«",cn:"é’é­”æ³•å¸ˆ",simple1:"é’",simple2:"é’é­”",icon:"062036",iconFramed:"062136",iconV3:"062416"},GNB:{en:"Gunbreaker",ja:"ã‚¬ãƒ³ãƒ–ãƒ¬ã‚¤ã‚«ãƒ¼",cn:"ç»æªæˆ˜å£«",simple1:"ç»",simple2:"ç»æª",icon:"062037",iconFramed:"062137",iconV3:"062417"},DNC:{en:"Dancer",ja:"è¸Šã‚Šå­",cn:"èˆè€…",simple1:"èˆ",simple2:"èˆè€…",icon:"062038",iconFramed:"062138",iconV3:"062418"},RPR:{en:"Reaper",ja:"ãƒªãƒ¼ãƒ‘ãƒ¼",cn:"é’é•°å®¢",simple1:"é•°",simple2:"é’é•°",icon:"062039",iconFramed:"062139",iconV3:"062419"},SGE:{en:"Sage",ja:"è³¢è€…",cn:"è´¤è€…",simple1:"è´¤",simple2:"è´¤è€…",icon:"062040",iconFramed:"062140",iconV3:"062420"}},ue=Object.keys(W),Ge=["tank","healer","dps","crafter","gatherer","none"],w=["GLA","PLD","MRD","WAR","DRK","GNB"],M=["CNJ","WHM","SCH","AST","SGE"],k=["PGL","MNK","LNC","DRG","ROG","NIN","SAM","RPR"],J=["ARC","BRD","DNC","MCH"],F=["BLU","RDM","BLM","SMN","ACN","THM"],ge=[...k,...J,...F],ze=[...w,...M,...k,...J,...F],Ke=[...w,...M,...k,...J,...F,"NONE"],X=["CRP","BSM","ARM","GSM","LTW","WVR","ALC","CUL"],Q=["MIN","BTN","FSH"],Ye=["BLU",...w,...k],Ze=["BLU",...w,...J],_e=["BLM","BLU",...M],qe=[...k],Xe=[...F],Qe=["BLU","BRD",...M],en=(()=>{const e=(i,r,s)=>{r.forEach(m=>i.set(m,s))},t=new Map([["NONE","none"]]);return e(t,w,"tank"),e(t,M,"healer"),e(t,ge,"dps"),e(t,X,"crafter"),e(t,Q,"gatherer"),t})();let A=U;try{const e=localStorage.getItem(q);e&&(A=JSON.parse(e))}catch(e){console.error("JSON.parse localConfig error",e)}const B={jobEnumToJob:e=>ue.find(i=>W[i]===e)??"NONE",jobEnumToJobIconPath:e=>{const i=e??43;if(A.targetType===h.JobName)return"";if(A.targetType===h.JobIcon)return Y(`0620${i.toString().padStart(2,"0")}`);if(A.targetType===h.JobIconV2)return Y(`0621${i.toString().padStart(2,"0")}`);if(A.targetType===h.JobIconV3){const r=pe[B.jobEnumToJob(e)];return Y(r.iconV3)}return""},jobToJobEnum:e=>W[e],jobToRole:e=>en.get(e)??"none",getAllRoles:()=>Ge,isTankJob:e=>w.includes(e),isHealerJob:e=>M.includes(e),isMeleeDpsJob:e=>k.includes(e),isRangedDpsJob:e=>J.includes(e),isCasterDpsJob:e=>F.includes(e),isDpsJob:e=>ge.includes(e),isCraftingJob:e=>X.includes(e),isGatheringJob:e=>Q.includes(e),isCombatJob:e=>!X.includes(e)&&!Q.includes(e),canStun:e=>Ye.includes(e),canSilence:e=>Ze.includes(e),canSleep:e=>_e.includes(e),canCleanse:e=>Qe.includes(e),canFeint:e=>qe.includes(e),canAddle:e=>Xe.includes(e),getAllJobs:()=>ue,getBattleJobs:()=>ze,getBattleJobs2:()=>Ke,nameToFullName:e=>pe[e],iconToJobEnum:e=>$e[e]??0,nameToJobEnum:e=>W[e]??0};let _=!1;const nn=(e,t)=>{const{startTimer:i,stopTimer:r}=Be(e,t);return{onInCombatChangedEvent:l=>{_!==l.detail.inACTCombat&&(l.detail.inACTCombat?i(Date.now()):r(Date.now()),_=l.detail.inACTCombat)},onChangePrimaryPlayer:l=>{t({type:p.ChangePlayer,payload:{playerId:l.charID.toString(16).toUpperCase(),playerName:l.charName}})},onPartyChanged:l=>{t({type:p.PartyChange,payload:{party:l.party.filter(j=>j.inParty).map(j=>{const N=B.jobEnumToJobIconPath(j.job);return{...j,jobName:B.nameToFullName(B.jobEnumToJob(j.job)).simple2,jobIconPath:N,jobIconUrl:Le(N),jobIconFallbackUrl:Re(N)}})}})},onChangeZone:l=>{t({type:p.MoveDataToHistoricalData}),setTimeout(()=>{t({type:p.ChangeZone,payload:{zoneID:l.zoneID,zoneName:l.zoneName}})},500),_&&r(Date.now())},onPlayerChangedEvent:l=>{},onCombatData:l=>{}}},an=(e,t)=>{const i=Math.abs(e-t)/1e3,r=Math.floor(i/60),s=Math.floor(i%60);return`${String(r).padStart(2,"0")}:${String(s).padStart(2,"0")}`},tn=6,on={list:[],startTime:void 0,lastStartTime:void 0,endTime:void 0,inCombat:!1,combatDuration:"00:00",dataObjectMap:new Map,timer:void 0,playerId:"",playerName:"",party:[],zoneID:"",zoneName:"",historicalData:[],activeHistoricalKey:"",activeHistoricalData:void 0,rsvData:{}},sn=(e,t)=>{const i=t.payload,r=e.party.find(s=>s.id===i.targetId);if(i.effects&&(i.effects=i.effects.map(s=>({...s,isOwner:s.sourceId===e.playerId}))),i.type===f.Ability){if(r)return i.duration=e.combatDuration,i.target=r.jobName,i.targetIconUrl=r.jobIconUrl,i.targetIconFallbackUrl=r.jobIconFallbackUrl,{...e,list:[i,...e.list]};if(i.targetId===e.playerId)return i.duration=e.combatDuration,i.target="YOU",{...e,list:[i,...e.list]}}if(i.type===f.DoT){if(r)return i.duration=e.combatDuration,i.ability="DoT",i.target=r.jobName,i.targetIconUrl=r.jobIconUrl,i.targetIconFallbackUrl=r.jobIconFallbackUrl,{...e,list:[i,...e.list]};if(i.targetId===e.playerId)return i.duration=e.combatDuration,i.ability="DoT",i.target="YOU",{...e,list:[i,...e.list]}}if(i.type===f.Defeated){if(!r&&i.targetId!==e.playerId)return e;i.duration=e.combatDuration;let s=i.target;return i.targetId===e.playerId?s="ä½ ":r&&(s=`${r.jobName} (${r.name}) `),i.ability=`ğŸ¥º ${s}è¢«${i.source}åšæ‰äº†ï¼`,{...e,list:[i,...e.list]}}return i.type===f.Wipe?(i.duration=e.combatDuration,{...e,list:[i,...e.list]}):e},rn=(e,t)=>e.startTime||e.endTime&&t.startTime-e.endTime<1e3*5?(clearInterval(t.timer),e):(e.timer&&clearInterval(e.timer),{...e,startTime:t.startTime,endTime:t.endTime,inCombat:t.inCombat,combatDuration:t.combatDuration,timer:t.timer}),ln=(e,t)=>(e.timer&&clearInterval(e.timer),{...e,startTime:t.startTime,endTime:t.endTime,lastStartTime:e.startTime,timer:t.timer,inCombat:t.inCombat}),cn=(e,t)=>e.startTime?{...e,combatDuration:an(Date.now(),e.startTime)}:(clearInterval(e.timer),e),mn=(e,t)=>({...e,...t.payload}),dn=(e,t)=>({...e,...t.payload}),pn=(e,t)=>({...e,...t.payload}),un=(e,t)=>{try{const{list:i,startTime:r,lastStartTime:s,endTime:m,combatDuration:C,playerId:P,playerName:T,party:D,zoneID:l,zoneName:j,historicalData:N,timer:V}=e;if(i.length===0)return e;V&&clearInterval(V);const E={key:i[0].key,list:JSON.parse(JSON.stringify(i)),startTime:s??r,endTime:m,combatDuration:C,playerId:P,playerName:T,party:JSON.parse(JSON.stringify(D)),zoneID:l,zoneName:j};return e.dataObjectMap.clear(),N.length>=tn&&N.pop(),{...e,startTime:void 0,lastStartTime:void 0,endTime:void 0,timer:void 0,inCombat:!1,list:[],historicalData:[E,...e.historicalData],activeHistoricalKey:i[0].key,activeHistoricalData:E}}catch(i){return console.error("handleMoveDataToHistoricalData Error: ",i),e}},hn=(e,t)=>{const i=t.activeHistoricalKey,r=e.historicalData.find(s=>s.key===i);return{...e,activeHistoricalData:r,activeHistoricalKey:i}},gn=(e,t)=>(t.key&&t.value&&(e.rsvData[t.key]=t.value),e),fn=(e,t)=>{switch(t.type){case p.AddList:return sn(e,t);case p.StartCombat:return rn(e,t);case p.EndCombat:return ln(e,t);case p.UpdateDuration:return cn(e);case p.ChangePlayer:return mn(e,t);case p.PartyChange:return dn(e,t);case p.ChangeZone:return pn(e,t);case p.MoveDataToHistoricalData:return un(e);case p.SetActiveHistoricalData:return hn(e,t);case p.UpdateRSVData:return gn(e,t);default:throw Error("Unknown action: "+t.type)}},bn=()=>{const[e,t]=b.useReducer(fn,on);return{state:e,dispatch:t}},he=e=>e?Ae==="Chinese"?e.slice(0,2):e.split(" ").map(r=>r.charAt(0).toUpperCase()).join(".")+".":"";function yn(){var re,le,ce,me;let e=U;try{const n=localStorage.getItem(q);n&&(e=JSON.parse(n))}catch(n){console.error("JSON.parse localConfig error",n)}const[t,i]=b.useState(window.innerWidth),[r,s]=b.useState(window.innerHeight),[m,C]=b.useState(Je),[P,T]=b.useState(!1),D=b.useRef(null),[l,j]=b.useState(e),[N,V]=b.useState(!0),[E,H]=b.useState(!0),[$]=g.useForm(),[fe,be]=Pe.useMessage(),{state:c,dispatch:G}=bn(),{onLogLine:ee}=Fe(l,c,G),{onInCombatChangedEvent:ne,onChangePrimaryPlayer:ae,onPartyChanged:te,onChangeZone:ie}=nn(c,G),oe=()=>{i(window.innerWidth),s(window.innerHeight)},se=n=>{var o;"isLocked"in(n==null?void 0:n.detail)&&V((o=n==null?void 0:n.detail)==null?void 0:o.isLocked)},ye=async()=>{const n=await $.validateFields();j(n),localStorage.setItem(q,JSON.stringify(n)),T(!1)},je=()=>T(!1),xe=()=>{$.setFieldsValue(U)},Ce=n=>{var d;let o="";n.type===f.Ability?n.isDodge?o=`${n.duration} ${n.source} ä½¿ç”¨ ${n.ability} å¯¹ ${n.targetName} é€ æˆäº† ${n.damage} ç‚¹ä¼¤å®³ï¼Œä¼¼ä¹æ²¡æœ‰æ•ˆæœï¼Œä¼¤å®³è¢«å›é¿äº†ï¼`:(o=`${n.duration} ${n.source} ä½¿ç”¨ ${n.ability} å¯¹ ${n.targetName} é€ æˆäº† ${n.damage} ç‚¹${n.damageType===Z.Physics?"ç‰©ç†":n.damageType===Z.Magic?"é­”æ³•":""}ä¼¤å®³
`,n.mutation&&~~n.mutation>0&&(o+=`å‡ä¼¤ç™¾åˆ†æ¯”ï¼š${n.mutation}%ï¼Œ`),(n.effects&&n.effects.length>0||n.isBlock||n.isParried)&&(o+=`çŠ¶æ€ï¼š${[...n.effects?(d=n.effects)==null?void 0:d.map(u=>u.effect):[],...n.isBlock?["æ ¼æŒ¡"]:[],...n.isParried?["æ‹›æ¶"]:[]].join(" ")}`)):n.type===f.Defeated?o=`${n.duration} ${n.ability}`:n.type===f.Wipe?o=`${n.duration} ${n.ability}`:n.type===f.DoT&&(o=`${n.duration} ${n.source} å¯¹ ${n.targetName} é€ æˆäº† ${n.damage} ç‚¹DoTä¼¤å®³`),o&&(we(o),fe.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿"))};b.useEffect(()=>(L("LogLine",ee),L("onInCombatChangedEvent",ne),L("ChangePrimaryPlayer",ae),L("PartyChanged",te),L("ChangeZone",ie),addEventListener("resize",oe),document.addEventListener("onOverlayStateUpdate",se),()=>{R("LogLine",ee),R("onInCombatChangedEvent",ne),R("ChangePrimaryPlayer",ae),R("PartyChanged",te),R("ChangeZone",ie),removeEventListener("resize",oe),document.removeEventListener("onOverlayStateUpdate",se)}),[]),b.useEffect(()=>{setTimeout(()=>{const n=new URLSearchParams(window.location.search),o=n.get("OVERLAY_WS"),d=n.get("HOST_PORT");if(!window.OverlayPluginApi&&!o&&!d&&H(!1),!window.OverlayPluginApi&&(o||d)){const u=o||d,x=function(de){const z=new WebSocket(de);z.addEventListener("error",jn=>{H(!1)}),z.addEventListener("open",()=>{H(!0)}),z.addEventListener("close",()=>{H(!1),window.setTimeout(()=>{x(de)},300)})};x(u)}},1e3)},[]),b.useEffect(()=>{if(D.current){const n=document.querySelector(".ant-table-header");n!=null&&n.clientHeight&&C(n.clientHeight)}},[D.current]);const Ne=(n,o)=>{const{targetType:d,showTargetName:u}=l;return o.targetIconUrl?d===h.JobName?a.jsx(O,{content:o.targetName,children:a.jsxs("div",{children:[a.jsx("div",{children:n}),u===I.Yes?a.jsx("div",{children:he(o.targetName??"")}):null]})}):[h.JobIcon,h.JobIconV2,h.JobIconV3].includes(d)?a.jsx(O,{content:o.targetName,children:a.jsxs("div",{className:"flex justify-center flex-wrap w-7",children:[a.jsx(S,{width:20,src:o.targetIconUrl,fallback:o.targetIconFallbackUrl,preview:!1}),u===I.Yes?a.jsx("div",{className:K({"-mt-1":[h.JobIcon,h.JobIconV3].includes(d)}),children:he(o.targetName??"")}):null]})}):null:a.jsx(O,{content:o.targetName,children:n})},ve=[{title:"æ—¶é—´",dataIndex:"duration",key:"duration",width:l.durationWidth,shouldCellUpdate:(n,o)=>n.duration!==o.duration,render:n=>a.jsx("div",{className:"flex items-center h-full",children:a.jsx("span",{children:n})})},{title:"æŠ€èƒ½",dataIndex:"ability",key:"ability",width:l.abilityWidth,shouldCellUpdate:(n,o)=>n.ability!==o.ability,render:(n,o)=>o.type===f.Ability?a.jsx("div",{className:"flex items-center h-full break-all",children:a.jsx("span",{children:n.startsWith("unknown_")?"æœªçŸ¥":n})}):o.type===f.DoT?a.jsx("div",{className:"flex items-center h-full break-all italic",children:a.jsx("span",{children:n})}):a.jsx("div",{className:"flex items-center h-full w-72 font-bold",children:a.jsx("span",{children:n})})},{title:"ç›®æ ‡",dataIndex:"target",key:"target",width:l.targetWidth,shouldCellUpdate:(n,o)=>n.target!==o.target,filters:c.list.length>0?c.party.length>0?c.party.map(n=>({text:`${n.jobName} - ${n.name}`,value:n.id})):void 0:((re=c==null?void 0:c.activeHistoricalData)==null?void 0:re.party.length)>0?(le=c==null?void 0:c.activeHistoricalData)==null?void 0:le.party.map(n=>({text:`${n.jobName} - ${n.name}`,value:n.id})):void 0,onFilter:(n,o)=>o.targetId===n,render:(n,o)=>o.type===f.Ability||o.type===f.DoT?a.jsx("div",{className:"flex items-center h-full",children:Ne(n,o)}):null},{title:"ä¼¤å®³",dataIndex:"damage",key:"damage",width:l.damageWidth,shouldCellUpdate:(n,o)=>n.damage!==o.damage,sorter:(n,o)=>{const d=~~n.damage,u=~~o.damage;return d-u},sortDirections:["descend"],render:(n,o)=>{var d,u,x;return a.jsxs("div",{className:"flex flex-wrap items-center h-full",children:[(d=o.damageIcon)!=null&&d.url?a.jsx(S,{className:"pr-0.5",width:16,src:(u=o.damageIcon)==null?void 0:u.url,fallback:(x=o.damageIcon)==null?void 0:x.fallbackUrl,preview:!1}):null,a.jsx("span",{className:o.damageType===Z.Dodge?"line-through":"",children:n})]})}},{title:"å‡ä¼¤",dataIndex:"mutation",key:"mutation",width:l.mutationWidth,shouldCellUpdate:(n,o)=>n.mutation!==o.mutation,render:n=>n&&n!=="0"&&n>0?a.jsx("div",{className:"flex items-center h-full",children:a.jsxs("span",{children:[n,"%"]})}):null},{title:"çŠ¶æ€",dataIndex:"effects",key:"effects",shouldCellUpdate:(n,o)=>{var d,u;return((d=n.effects)==null?void 0:d.map(x=>x.effectId).join(","))!==((u=o.effects)==null?void 0:u.map(x=>x.effectId).join(","))},render:n=>a.jsx("div",{className:"flex items-center flex-wrap min-h-full",children:n==null?void 0:n.map(o=>a.jsx(O,{content:`${o.effect} ${o.source}`,children:a.jsxs("div",{className:"relative",children:[a.jsx(S,{className:o.isUsefull?"":"grayscale",width:18,src:o.url,fallback:o.fallbackUrl,preview:!1}),a.jsx("span",{className:K("absolute -bottom-2 left-0 text-center min-w-full",{"text-green-300":o.isOwner}),children:o.duration})]})},o.effectId))})}],Te=c.historicalData.map(n=>({key:n.key,label:a.jsxs("div",{children:[a.jsxs("div",{className:K({"text-cyan-400 font-bold":c.list.length===0&&c.activeHistoricalKey===n.key}),children:[a.jsx("span",{className:"mr-2",children:n.combatDuration}),a.jsx("span",{children:n.zoneName})]}),n.startTime?a.jsx("div",{children:a.jsx("span",{children:new Date(n.startTime).toLocaleString()})}):null]})})),De=({key:n})=>{G({type:p.SetActiveHistoricalData,activeHistoricalKey:n})};return a.jsx(Ve,{theme:{algorithm:[Ee.darkAlgorithm],components:{Table:{colorBgContainer:`rgba(67, 67, 67, ${l.opacity?l.opacity/100:.45})`,colorText:"#fafafa",fontSize:l.fontSize,algorithm:!0}}},children:a.jsxs("div",{className:"w-screen relative",children:[be,a.jsx(He,{ref:D,rowClassName:n=>n.type===f.Wipe?"wipe":"",onRow:n=>({onClick:()=>Ce(n)}),columns:ve,dataSource:((ce=c==null?void 0:c.list)==null?void 0:ce.length)>0?c==null?void 0:c.list:((me=c==null?void 0:c.activeHistoricalData)==null?void 0:me.list)??[],pagination:!1,virtual:!0,scroll:{x:t,y:r-m},size:"small"}),a.jsxs("div",{className:"absolute top-1.5 right-2",children:[a.jsx(Oe,{menu:{items:Te,onClick:De},arrow:!1,children:a.jsx(Ie,{className:"mr-3 text-zinc-50"})}),a.jsx(Se,{className:"text-zinc-50",onClick:()=>T(!0)})]}),a.jsx(Ue,{title:"è®¾ç½®",className:"top-5",classNames:{body:"overflow-y-scroll"},styles:{body:{maxHeight:r-160}},open:P,onOk:ye,onCancel:je,okText:"ä¿å­˜",cancelText:"å–æ¶ˆ",children:a.jsxs(g,{form:$,name:"setting",size:"small",labelCol:{span:6},wrapperCol:{span:18},initialValues:{...U,...l},children:[a.jsx("div",{className:"mb-5",children:"ï¼ˆæ³¨ï¼šç›®æ ‡åˆ—ã€Dotçš„è®¾ç½®éœ€è¦åˆ·æ–°æ‚¬æµ®çª—åç”Ÿæ•ˆï¼Œä¸‹é¢æœ‰åˆ—å®½è®¾ç½®ï¼‰"}),a.jsx(g.Item,{name:"targetType",label:"ç›®æ ‡åˆ—å±•ç¤ºæ–¹å¼",className:"mb-3",children:a.jsxs(y.Group,{children:[a.jsx(y,{value:h.JobName,children:"å­¦è€…"}),a.jsx(y,{value:h.JobIcon,children:a.jsxs("div",{className:"flex justify-center flex-wrap w-7",children:[a.jsx(S,{width:20,src:"https://cafemaker.wakingsands.com/i/062000/062028.png",fallback:"https://xivapi.com/i/062000/062028.png",preview:!1}),a.jsx("div",{className:"-mt-1",children:"ä¸ç“œ"})]})}),a.jsx(y,{value:h.JobIconV2,children:a.jsxs("div",{className:"flex justify-center flex-wrap w-7",children:[a.jsx(S,{width:20,src:"https://cafemaker.wakingsands.com/i/062000/062128.png",fallback:"https://xivapi.com/i/062000/062128.png",preview:!1}),a.jsx("div",{className:"",children:"ä¸ç“œ"})]})}),a.jsx(y,{value:h.JobIconV3,children:a.jsxs("div",{className:"flex justify-center flex-wrap w-7",children:[a.jsx(S,{width:20,src:"https://cafemaker.wakingsands.com/i/062000/062409.png",fallback:"https://xivapi.com/i/062000/062409.png",preview:!1}),a.jsx("div",{className:"-mt-1",children:"ä¸ç“œ"})]})})]})}),a.jsx(g.Item,{name:"showTargetName",label:"å±•ç¤ºåç§°ç¼©å†™",children:a.jsxs(y.Group,{children:[a.jsx(y,{value:I.Yes,children:"æ˜¯"}),a.jsx(y,{value:I.No,children:"å¦"})]})}),a.jsx(g.Item,{name:"showDotDamage",label:"å±•ç¤ºDotä¼¤å®³",children:a.jsxs(y.Group,{children:[a.jsx(y,{value:I.Yes,children:"æ˜¯"}),a.jsx(y,{value:I.No,children:"å¦"})]})}),a.jsx(g.Item,{label:"å­—ä½“å¤§å°",name:"fontSize",children:a.jsx(v,{max:32,min:10})}),a.jsx(g.Item,{label:"èƒŒæ™¯é€æ˜åº¦",name:"opacity",children:a.jsx(v,{max:100,min:1})}),a.jsx(g.Item,{label:"æ—¶é—´åˆ—å®½",name:"durationWidth",children:a.jsx(v,{min:1})}),a.jsx(g.Item,{label:"æŠ€èƒ½åˆ—å®½",name:"abilityWidth",children:a.jsx(v,{min:1,max:200})}),a.jsx(g.Item,{label:"ç›®æ ‡åˆ—å®½",name:"targetWidth",children:a.jsx(v,{min:1,max:200})}),a.jsx(g.Item,{label:"ä¼¤å®³åˆ—å®½",name:"damageWidth",children:a.jsx(v,{min:1})}),a.jsx(g.Item,{label:"å‡ä¼¤åˆ—å®½",name:"mutationWidth",children:a.jsx(v,{min:1})}),a.jsx(g.Item,{label:"é‡ç½®å…¨éƒ¨",children:a.jsx(We,{type:"default",onClick:xe,children:"åˆå§‹åŒ–"})})]})}),N?null:a.jsx("div",{className:"fixed top-0 left-0 w-screen h-screen rounded-md bg-zinc-500/50 z-10",children:a.jsx("div",{className:"absolute bottom-2 left-2 text-sm text-black",children:'ğŸ”“ è¯·è°ƒæ•´è‡³åˆé€‚å¤§å°ï¼Œéšååœ¨ACTå‹¾é€‰"é”å®šæ‚¬æµ®çª—"ä»¥å¼€å§‹ä½¿ç”¨ã€‚'})}),E?null:a.jsx("div",{className:"fixed top-0 left-0 w-screen h-screen rounded-md bg-zinc-500/50 z-10",children:a.jsx("div",{className:"absolute bottom-2 left-2 text-sm text-black",children:"âš ï¸ è¯·åœ¨ACTæ‚¬æµ®çª—ä¸­æ·»åŠ æ­¤é¡µé¢ã€‚"})})]})})}Me.createRoot(document.getElementById("root")).render(a.jsx(ke.StrictMode,{children:a.jsx(yn,{})}));
